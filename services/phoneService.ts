// 国家代码到电话号码前缀的映射表
const countryPhonePrefixes: Record<string, string> = {
  US: "+1", // 美国
  CA: "+1", // 加拿大
  GB: "+44", // 英国
  AU: "+61", // 澳大利亚
  DE: "+49", // 德国
  FR: "+33", // 法国
  JP: "+81", // 日本
  CN: "+86", // 中国
  IN: "+91", // 印度
  BR: "+55", // 巴西
  RU: "+7", // 俄罗斯
  IT: "+39", // 意大利
  KR: "+82", // 韩国
  ES: "+34", // 西班牙
  MX: "+52", // 墨西哥
  ID: "+62", // 印度尼西亚
  TR: "+90", // 土耳其
  NL: "+31", // 荷兰
  CH: "+41", // 瑞士
  SE: "+46", // 瑞典
  NO: "+47", // 挪威
  DK: "+45", // 丹麦
  FI: "+358", // 芬兰
  PL: "+48", // 波兰
  PT: "+351", // 葡萄牙
  GR: "+30", // 希腊
  BE: "+32", // 比利时
  AT: "+43", // 奥地利
  IE: "+353", // 爱尔兰
  NZ: "+64", // 新西兰
  SG: "+65", // 新加坡
  MY: "+60", // 马来西亚
  TH: "+66", // 泰国
  PH: "+63", // 菲律宾
  VN: "+84", // 越南
  ZA: "+27", // 南非
  AR: "+54", // 阿根廷
  CL: "+56", // 智利
  CO: "+57", // 哥伦比亚
  PE: "+51", // 秘鲁
  EG: "+20", // 埃及
  SA: "+966", // 沙特阿拉伯
  AE: "+971", // 阿联酋
  IL: "+972", // 以色列
  PK: "+92", // 巴基斯坦
  BD: "+880", // 孟加拉国
  NG: "+234", // 尼日利亚
  KE: "+254", // 肯尼亚
  TZ: "+255", // 坦桑尼亚
  GH: "+233", // 加纳
  MA: "+212", // 摩洛哥
  DZ: "+213", // 阿尔及利亚
  TN: "+216", // 突尼斯
  LY: "+218", // 利比亚
  SD: "+249", // 苏丹
  ET: "+251", // 埃塞俄比亚
  SO: "+252", // 索马里
  UG: "+256", // 乌干达
  RW: "+250", // 卢旺达
  BI: "+257", // 布隆迪
  CD: "+243", // 刚果民主共和国
  CG: "+242", // 刚果共和国
  ZM: "+260", // 赞比亚
  ZW: "+263", // 津巴布韦
  MZ: "+258", // 莫桑比克
  AO: "+244", // 安哥拉
  NA: "+264", // 纳米比亚
  BW: "+267", // 博茨瓦纳
  LS: "+266", // 莱索托
  SZ: "+268", // 斯威士兰
  MW: "+265", // 马拉维
  MG: "+261", // 马达加斯加
  MU: "+230", // 毛里求斯
  SC: "+248", // 塞舌尔
  KM: "+269", // 科摩罗
  RE: "+262", // 留尼汪
  CI: "+225", // 科特迪瓦
  GM: "+220", // 冈比亚
  GN: "+224", // 几内亚
  GW: "+245", // 几内亚比绍
  LR: "+231", // 利比里亚
  SL: "+232", // 塞拉利昂
  TG: "+228", // 多哥
  BJ: "+229", // 贝宁
  NE: "+227", // 尼日尔
  TD: "+235", // 乍得
  CF: "+236", // 中非共和国
  CM: "+237", // 喀麦隆
  GA: "+241", // 加蓬
  GQ: "+240", // 赤道几内亚
  ST: "+239", // 圣多美和普林西比
  CV: "+238", // 佛得角
  SN: "+221", // 塞内加尔
  MR: "+222", // 毛里塔尼亚
  ER: "+291", // 厄立特里亚
  DJ: "+253", // 吉布提
  BF: "+226", // 布基纳法索
  ML: "+223" // 马里
};

// 国家代码到电话号码格式的映射表
// 格式说明: # 代表数字, x 代表可选数字
const countryPhoneFormats: Record<string, string> = {
  // 北美
  US: "(###) ###-####", // 美国: (123) 456-7890
  CA: "(###) ###-####", // 加拿大: (123) 456-7890
  
  // 欧洲
  GB: "+44 ### #### ###", // 英国: +44 123 456 789
  DE: "+49 ### ########", // 德国: +49 123 45678901
  FR: "+33 # ## ## ## ##", // 法国: +33 1 23 45 67 89
  IT: "+39 ### ########", // 意大利: +39 123 45678901
  ES: "+34 ### #######", // 西班牙: +34 123 456789
  NL: "+31 ### ######", // 荷兰: +31 123 456789
  CH: "+41 ## #######", // 瑞士: +41 12 3456789
  SE: "+46 ### ### ###", // 瑞典: +46 123 456 789
  NO: "+47 ### ## ###", // 挪威: +47 123 45 678
  DK: "+45 #### ####", // 丹麦: +45 1234 5678
  FI: "+358 ### ######", // 芬兰: +358 123 456789
  PL: "+48 ### ### ###", // 波兰: +48 123 456 789
  PT: "+351 ### ### ###", // 葡萄牙: +351 123 456 789
  GR: "+30 ### #######", // 希腊: +30 123 4567890
  BE: "+32 ## ### ####", // 比利时: +32 12 345 6789
  AT: "+43 ### #######", // 奥地利: +43 123 4567890
  IE: "+353 ### ######", // 爱尔兰: +353 123 456789
  
  // 亚太
  AU: "+61 # ### ####", // 澳大利亚: +61 2 1234 5678
  JP: "+81 # ####-####", // 日本: +81 3 1234-5678
  CN: "+86 ### #### ####", // 中国: +86 138 1234 5678
  IN: "+91 ### #######", // 印度: +91 123 4567890
  KR: "+82 ###-####-####", // 韩国: +82 10-1234-5678
  ID: "+62 ### ##########", // 印度尼西亚: +62 123 456789012
  SG: "+65 ### #######", // 新加坡: +65 123 456789
  MY: "+60 # ### ####", // 马来西亚: +60 12 345 6789
  TH: "+66 ### ### ####", // 泰国: +66 123 456 7890
  PH: "+63 ### ######", // 菲律宾: +63 123 456789
  VN: "+84 ### ### ####", // 越南: +84 123 456 7890
  NZ: "+64 # ### ####", // 新西兰: +64 2 123 4567
  
  // 拉美
  BR: "+55 (##) #####-####", // 巴西: +55 (11) 12345-6789
  MX: "+52 (##) ####-####", // 墨西哥: +52 (12) 1234-5678
  AR: "+54 (##) ####-####", // 阿根廷: +54 (11) 1234-5678
  CL: "+56 (##) ####-####", // 智利: +56 (2) 1234-5678
  CO: "+57 (##) ####-####", // 哥伦比亚: +57 (1) 1234-5678
  PE: "+51 (##) ####-####", // 秘鲁: +51 (1) 1234-5678
  
  // 中东
  TR: "+90 (##) ### ## ##", // 土耳其: +90 (12) 345 67 89
  SA: "+966 ### #######", // 沙特阿拉伯: +966 5 1234 5678
  AE: "+971 ### #######", // 阿联酋: +971 5 1234 5678
  IL: "+972 ### #######", // 以色列: +972 5 1234 5678
  PK: "+92 ### #######", // 巴基斯坦: +92 3 1234 5678
  BD: "+880 ### #######", // 孟加拉国: +880 1 1234 5678
  
  // 非洲
  EG: "+20 ### #######", // 埃及: +20 1 1234 5678
  ZA: "+27 ### ### ####", // 南非: +27 123 456 7890
  NG: "+234 ### #######", // 尼日利亚: +234 8 1234 5678
  KE: "+254 ### #######", // 肯尼亚: +254 7 1234 5678
  TZ: "+255 ### #######", // 坦桑尼亚: +255 7 1234 5678
  GH: "+233 ### #######", // 加纳: +233 2 1234 5678
  MA: "+212 ### #######", // 摩洛哥: +212 6 1234 5678
  DZ: "+213 ### #######", // 阿尔及利亚: +213 5 1234 5678
  TN: "+216 ### #######", // 突尼斯: +216 5 1234 5678
  LY: "+218 ### #######", // 利比亚: +218 91 123 4567
  SD: "+249 ### #######", // 苏丹: +249 91 123 4567
  ET: "+251 ### #######", // 埃塞俄比亚: +251 9 1234 5678
  SO: "+252 ### #######", // 索马里: +252 61 123 4567
  UG: "+256 ### #######", // 乌干达: +256 7 1234 5678
  RW: "+250 ### #######", // 卢旺达: +250 7 1234 5678
  BI: "+257 ### #######", // 布隆迪: +257 7 1234 5678
  CD: "+243 ### #######", // 刚果民主共和国: +243 8 1234 5678
  CG: "+242 ### #######", // 刚果共和国: +242 5 1234 5678
  ZM: "+260 ### #######", // 赞比亚: +260 9 1234 5678
  ZW: "+263 ### #######", // 津巴布韦: +263 7 1234 5678
  MZ: "+258 ### #######", // 莫桑比克: +258 8 1234 5678
  AO: "+244 ### #######", // 安哥拉: +244 9 1234 5678
  NA: "+264 ### #######", // 纳米比亚: +264 81 123 4567
  BW: "+267 ### #######", // 博茨瓦纳: +267 71 123 4567
  LS: "+266 ### #######", // 莱索托: +266 5 1234 5678
  SZ: "+268 ### #######", // 斯威士兰: +268 7 1234 5678
  MW: "+265 ### #######", // 马拉维: +265 8 1234 5678
  MG: "+261 ### #######", // 马达加斯加: +261 34 123 4567
  MU: "+230 ### #######", // 毛里求斯: +230 5 1234 5678
  SC: "+248 ### #######", // 塞舌尔: +248 2 1234 5678
  KM: "+269 ### #######", // 科摩罗: +269 3 1234 5678
  RE: "+262 ### #######", // 留尼汪: +262 6 1234 5678
  CI: "+225 ### #######", // 科特迪瓦: +225 07 1234 5678
  GM: "+220 ### #######", // 冈比亚: +220 3 1234 5678
  GN: "+224 ### #######", // 几内亚: +224 6 1234 5678
  GW: "+245 ### #######", // 几内亚比绍: +245 5 1234 5678
  LR: "+231 ### #######", // 利比里亚: +231 77 123 4567
  SL: "+232 ### #######", // 塞拉利昂: +232 7 1234 5678
  TG: "+228 ### #######", // 多哥: +228 9 1234 5678
  BJ: "+229 ### #######", // 贝宁: +229 9 1234 5678
  NE: "+227 ### #######", // 尼日尔: +227 9 1234 5678
  TD: "+235 ### #######", // 乍得: +235 6 1234 5678
  CF: "+236 ### #######", // 中非共和国: +236 75 123 4567
  CM: "+237 ### #######", // 喀麦隆: +237 6 1234 5678
  GA: "+241 ### #######", // 加蓬: +241 0 1234 5678
  GQ: "+240 ### #######", // 赤道几内亚: +240 222 12345
  ST: "+239 ### #######", // 圣多美和普林西比: +239 9 1234 5678
  CV: "+238 ### #######", // 佛得角: +238 9 1234 5678
  SN: "+221 ### #######", // 塞内加尔: +221 7 1234 5678
  MR: "+222 ### #######", // 毛里塔尼亚: +222 6 1234 5678
  ER: "+291 ### #######", // 厄立特里亚: +291 1 1234 5678
  DJ: "+253 ### #######", // 吉布提: +253 77 123 4567
  BF: "+226 ### #######", // 布基纳法索: +226 7 1234 5678
  ML: "+223 ### #######"  // 马里: +223 7 1234 5678
};

// 各国常用号码段规则
const countryNumberRanges: Record<string, string[]> = {
  // 北美
  US: ["201", "202", "203", "205", "206", "207", "208", "209", "210", "212", 
       "213", "214", "215", "216", "217", "218", "219", "224", "225", "228", 
       "229", "231", "234", "239", "240", "248", "251", "252", "253", "254"],
  CA: ["204", "226", "236", "249", "250", "289", "306", "343", "365", "387", 
       "403", "416", "418", "431", "437", "450", "506", "514", "519", "548"],
  
  // 欧洲
  GB: ["121", "122", "123", "124", "125", "127", "128", "131", "132", "133", 
       "134", "135", "136", "137", "138", "139", "141", "142", "143", "144"],
  DE: ["015", "016", "017", "018", "019", "020", "021", "022", "023", "024"],
  FR: ["01", "02", "03", "04", "05", "06", "07"],
  IT: ["320", "327", "330", "331", "333", "334", "335", "336", "337", "338", 
       "339", "340", "341", "342", "343", "344", "345", "346", "347", "348"],
  ES: ["600", "601", "602", "603", "604", "605", "606", "607", "608", "609", 
       "610", "611", "612", "613", "614", "615", "616", "617", "618", "619"],
  NL: ["61", "62", "63", "64", "65", "66", "67", "68", "69"],
  CH: ["75", "76", "77", "78", "79"],
  SE: ["70", "72", "73", "76", "77", "79"],
  NO: ["40", "41", "42", "44", "45", "46", "47", "48", "49"],
  DK: ["20", "21", "22", "23", "24", "25", "26", "27", "28", "29", 
       "30", "31", "32", "33", "34", "35", "36", "37", "38", "39"],
  FI: ["40", "41", "42", "43", "44", "45", "46", "47", "48", "49", 
       "50", "51", "52", "53", "54", "55", "56", "57", "58", "59"],
  PL: ["45", "50", "51", "53", "57", "60", "66", "69", "72", "73", 
       "78", "79", "88"],
  PT: ["91", "92", "93", "96"],
  GR: ["690", "693", "694", "695", "697", "698", "699"],
  BE: ["47", "48", "49"],
  AT: ["650", "651", "652", "653", "654", "655", "656", "657", "658", "659", 
       "660", "661", "662", "663", "664", "665", "666", "667", "668", "669"],
  IE: ["83", "85", "86", "87", "89"],
  
  // 亚太
  AU: ["02", "03", "04", "07", "08"],
  JP: ["03", "04", "05", "06", "07", "08", "09", "011", "012", "013", 
       "014", "015", "016", "017", "018", "019", "022", "023", "024", "025"],
  CN: ["130", "131", "132", "133", "134", "135", "136", "137", "138", "139", 
       "145", "146", "147", "148", "149", 
       "150", "151", "152", "153", "155", "156", "157", "158", "159", 
       "165", "166", "167", 
       "170", "171", "172", "173", "175", "176", "177", "178", 
       "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", 
       "191", "193", "195", "196", "197", "198", "199"],
  IN: ["91", "92", "93", "94", "95", "96", "97", "98", "99"],
  KR: ["010", "011", "016", "017", "018", "019"],
  ID: ["811", "812", "813", "814", "815", "816", "817", "818", "819", "821", 
       "822", "823", "828", "831", "832", "833", "852", "853", "855", "856"],
  SG: ["81", "82", "83", "84", "85", "86", "87", "88", "89", "90", 
       "91", "92", "93", "94", "95", "96", "97", "98", "99"],
  MY: ["10", "11", "12", "13", "14", "15", "16", "17", "18", "19"],
  TH: ["6", "8", "9"],
  PH: ["905", "906", "907", "908", "909", "915", "916", "917", "918", "919", 
       "920", "921", "922", "923", "925", "926", "927", "928", "929", "930"],
  VN: ["32", "33", "34", "35", "36", "37", "38", "39", "52", "56", 
       "58", "59", "70", "76", "77", "78", "79", "83", "84", "85", 
       "86", "88", "89", "90", "91", "92", "93", "94", "96", "97", 
       "98", "99"],
  NZ: ["21", "22", "27", "28", "29"],
  
  // 拉美
  BR: ["11", "12", "13", "14", "15", "16", "17", "18", "19", "21", 
       "22", "24", "27", "28", "31", "32", "33", "34", "35", "37"],
  MX: ["01", "044", "045", "12", "13", "14", "15", "16", "17", "18", 
       "19", "22", "23", "24", "25", "26", "27", "28", "29", "31"],
  AR: ["11", "22", "33", "44", "55", "66", "77", "88", "99"],
  CL: ["9", "8", "7"],
  CO: ["310", "311", "312", "313", "314", "315", "316", "317", "318", "319"],
  PE: ["96", "97", "98", "99", "95", "94", "93", "92", "91", "90"],
  
  // 中东
  TR: ["530", "531", "532", "533", "534", "535", "536", "537", "538", "539", 
       "540", "541", "542", "543", "544", "545", "546", "547", "548", "549"],
  SA: ["5", "05", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59"],
  AE: ["50", "52", "55", "56", "58"],
  IL: ["50", "52", "53", "54", "55", "57", "58", "59"],
  PK: ["300", "301", "302", "303", "304", "305", "306", "307", "308", "309"],
  BD: ["17", "18", "19", "13", "14", "15"],
  
  // 非洲
  EG: ["10", "11", "12", "15"],
  ZA: ["71", "72", "73", "74", "76", "78", "81", "82", "83", "84", 
       "86", "87", "88", "89", "91", "92", "93", "94", "95", "96", 
       "97", "98", "99"],
  NG: ["803", "806", "805", "809", "818", "816", "810", "814", "812", "815"],
  KE: ["70", "71", "72", "73", "74", "75", "76", "77", "78", "79"],
  TZ: ["71", "72", "73", "74", "75", "76", "77", "78", "79"],
  GH: ["20", "23", "24", "26", "54", "55", "57", "59"],
  MA: ["6", "7", "5"],
  DZ: ["5", "6", "7", "9"],
  TN: ["2", "3", "4", "5", "9"],
  LY: ["91", "92", "94", "95"],
  SD: ["91", "92", "93", "96"],
  ET: ["91", "93", "94", "96", "97", "98", "99"],
  SO: ["61", "62", "63", "65", "67", "68", "69"],
  UG: ["70", "71", "75", "77", "78", "79"],
  RW: ["72", "73", "78"],
  BI: ["79", "72", "73", "75"],
  CD: ["81", "82", "83", "84", "85", "86", "89"],
  CG: ["5", "6", "7", "8"],
  ZM: ["95", "96", "97", "98", "99"],
  ZW: ["71", "73", "77", "78", "79"],
  MZ: ["82", "83", "84", "85", "86", "87", "88", "89"],
  AO: ["91", "92", "93", "94", "99"],
  NA: ["81", "82", "83", "85", "86", "87", "88"],
  BW: ["71", "72", "73", "74", "75", "76", "77"],
  LS: ["5", "6", "7", "8"],
  SZ: ["76", "77", "78", "79"],
  MW: ["88", "99", "98", "97", "96"],
  MG: ["32", "33", "34", "38", "39"],
  MU: ["57", "58", "59"],
  SC: ["2", "4", "5", "7"],
  KM: ["33", "34", "35"],
  RE: ["6", "7"],
  CI: ["07", "08", "09"],
  GM: ["2", "3", "5"],
  GN: ["6", "7", "8"],
  GW: ["5", "6", "7"],
  LR: ["77", "78", "79"],
  SL: ["7", "8", "9"],
  TG: ["90", "91", "92", "93", "94", "95", "96", "97", "98", "99"],
  BJ: ["90", "91", "92", "93", "94", "95", "96", "97", "98", "99"],
  NE: ["90", "91", "92", "93", "94", "95", "96", "97", "98", "99"],
  TD: ["6", "7", "9"],
  CF: ["75", "76", "77", "78", "79"],
  CM: ["67", "68", "69", "70", "75", "76", "77", "78", "79"],
  GA: ["0", "4", "5", "6", "7"],
  GQ: ["222", "223", "224", "225", "226"],
  ST: ["9", "8", "7"],
  CV: ["9", "8", "7"],
  SN: ["70", "75", "76", "77", "78", "79"],
  MR: ["6", "7", "8"],
  ER: ["1", "2", "3", "4"],
  DJ: ["77", "78", "79"],
  BF: ["70", "71", "72", "73", "74", "75", "76", "77", "78", "79"],
  ML: ["70", "71", "72", "73", "74", "75", "76", "77", "78", "79"]
};

/**
 * 根据国家代码生成电话号码
 * @param countryCode 国家代码
 * @returns 格式化的电话号码
 */
export function generatePhoneNumber(countryCode: string): string {
  // 获取国家前缀
  const prefix = countryPhonePrefixes[countryCode] || "+1"; // 默认美国前缀
  
  // 获取电话号码格式
  let format = countryPhoneFormats[countryCode] || "### #######"; // 默认格式
  
  // 确保格式包含前缀
  if (!format.startsWith("+")) {
    format = prefix + " " + format;
  }
  
  // 生成随机数字，替换格式中的#符号
  let phoneNumber = format;
  
  // 特殊处理各国号码段规则
  if (countryNumberRanges[countryCode]) {
    const ranges = countryNumberRanges[countryCode];
    // 随机选择一个号码段
    const randomRange = ranges[Math.floor(Math.random() * ranges.length)];
    
    // 找到格式中需要替换的第一个#序列
    const firstHashMatch = phoneNumber.match(/#+/);
    if (firstHashMatch) {
      const firstHashIndex = phoneNumber.indexOf(firstHashMatch[0]);
      const hashLength = firstHashMatch[0].length;
      
      // 确保随机号码段长度与需要替换的#长度匹配
      let formattedRange = randomRange;
      if (formattedRange.length < hashLength) {
        // 如果号码段长度不足，后面补0
        formattedRange = formattedRange.padEnd(hashLength, '0');
      } else if (formattedRange.length > hashLength) {
        // 如果号码段长度过长，截取前面部分
        formattedRange = formattedRange.substring(0, hashLength);
      }
      
      // 替换第一个#序列为实际号码段
      phoneNumber = phoneNumber.substring(0, firstHashIndex) + formattedRange + phoneNumber.substring(firstHashIndex + hashLength);
    }
  }
  
  // 替换剩余的#为随机数字
  while (phoneNumber.includes("#")) {
    phoneNumber = phoneNumber.replace("#", Math.floor(Math.random() * 10).toString());
  }
  
  return phoneNumber;
}

/**
 * 根据国家名称获取国家代码
 * @param countryName 国家名称
 * @returns 国家代码
 */
export function getCountryCode(countryName: string): string {
  // 这里需要一个国家名称到国家代码的映射表
  // 暂时使用一个简化版本，实际应该使用完整的映射表
  const countryNameToCode: Record<string, string> = {
    "United States": "US",
    "Canada": "CA",
    "United Kingdom": "GB",
    "Australia": "AU",
    "Germany": "DE",
    "France": "FR",
    "Japan": "JP",
    "China": "CN",
    "India": "IN",
    "Brazil": "BR",
    "Russia": "RU",
    "Italy": "IT",
    "South Korea": "KR",
    "Spain": "ES",
    "Mexico": "MX",
    "Indonesia": "ID",
    "Turkey": "TR",
    "Netherlands": "NL",
    "Switzerland": "CH",
    "Sweden": "SE",
    "Norway": "NO",
    "Denmark": "DK",
    "Finland": "FI",
    "Poland": "PL",
    "Portugal": "PT",
    "Greece": "GR",
    "Belgium": "BE",
    "Austria": "AT",
    "Ireland": "IE",
    "New Zealand": "NZ",
    "Singapore": "SG",
    "Malaysia": "MY",
    "Thailand": "TH",
    "Philippines": "PH",
    "Vietnam": "VN",
    "South Africa": "ZA"
  };
  
  return countryNameToCode[countryName] || "US"; // 默认美国
}
