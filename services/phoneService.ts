// 国家代码到电话号码前缀的映射表
const countryPhonePrefixes: Record<string, string> = {
  US: "+1", // 美国
  CA: "+1", // 加拿大
  GB: "+44", // 英国
  AU: "+61", // 澳大利亚
  DE: "+49", // 德国
  FR: "+33", // 法国
  JP: "+81", // 日本
  CN: "+86", // 中国
  IN: "+91", // 印度
  BR: "+55", // 巴西
  RU: "+7", // 俄罗斯
  IT: "+39", // 意大利
  KR: "+82", // 韩国
  ES: "+34", // 西班牙
  MX: "+52", // 墨西哥
  ID: "+62", // 印度尼西亚
  TR: "+90", // 土耳其
  NL: "+31", // 荷兰
  CH: "+41", // 瑞士
  SE: "+46", // 瑞典
  NO: "+47", // 挪威
  DK: "+45", // 丹麦
  FI: "+358", // 芬兰
  PL: "+48", // 波兰
  PT: "+351", // 葡萄牙
  GR: "+30", // 希腊
  BE: "+32", // 比利时
  AT: "+43", // 奥地利
  IE: "+353", // 爱尔兰
  NZ: "+64", // 新西兰
  SG: "+65", // 新加坡
  MY: "+60", // 马来西亚
  TH: "+66", // 泰国
  PH: "+63", // 菲律宾
  VN: "+84", // 越南
  ZA: "+27", // 南非
  AR: "+54", // 阿根廷
  CL: "+56", // 智利
  CO: "+57", // 哥伦比亚
  PE: "+51", // 秘鲁
  EG: "+20", // 埃及
  SA: "+966", // 沙特阿拉伯
  AE: "+971", // 阿联酋
  IL: "+972", // 以色列
  PK: "+92", // 巴基斯坦
  BD: "+880", // 孟加拉国
  NG: "+234", // 尼日利亚
  KE: "+254", // 肯尼亚
  TZ: "+255", // 坦桑尼亚
  GH: "+233", // 加纳
  MA: "+212", // 摩洛哥
  DZ: "+213", // 阿尔及利亚
  TN: "+216", // 突尼斯
  LY: "+218", // 利比亚
  SD: "+249", // 苏丹
  ET: "+251", // 埃塞俄比亚
  SO: "+252", // 索马里
  UG: "+256", // 乌干达
  RW: "+250", // 卢旺达
  BI: "+257", // 布隆迪
  CD: "+243", // 刚果民主共和国
  CG: "+242", // 刚果共和国
  ZM: "+260", // 赞比亚
  ZW: "+263", // 津巴布韦
  MZ: "+258", // 莫桑比克
  AO: "+244", // 安哥拉
  NA: "+264", // 纳米比亚
  BW: "+267", // 博茨瓦纳
  LS: "+266", // 莱索托
  SZ: "+268", // 斯威士兰
  MW: "+265", // 马拉维
  MG: "+261", // 马达加斯加
  MU: "+230", // 毛里求斯
  SC: "+248", // 塞舌尔
  KM: "+269", // 科摩罗
  RE: "+262", // 留尼汪
  CI: "+225", // 科特迪瓦
  GM: "+220", // 冈比亚
  GN: "+224", // 几内亚
  GW: "+245", // 几内亚比绍
  LR: "+231", // 利比里亚
  SL: "+232", // 塞拉利昂
  TG: "+228", // 多哥
  BJ: "+229", // 贝宁
  NE: "+227", // 尼日尔
  TD: "+235", // 乍得
  CF: "+236", // 中非共和国
  CM: "+237", // 喀麦隆
  GA: "+241", // 加蓬
  GQ: "+240", // 赤道几内亚
  ST: "+239", // 圣多美和普林西比
  CV: "+238", // 佛得角
  SN: "+221", // 塞内加尔
  MR: "+222", // 毛里塔尼亚
  ER: "+291", // 厄立特里亚
  DJ: "+253", // 吉布提
  BF: "+226", // 布基纳法索
  ML: "+223" // 马里
};

// 国家代码到电话号码格式的映射表
// 格式说明: # 代表数字, x 代表可选数字
const countryPhoneFormats: Record<string, string> = {
  US: "(###) ###-####", // 美国: (123) 456-7890
  CA: "(###) ###-####", // 加拿大: (123) 456-7890
  GB: "+44 ### #### ###", // 英国: +44 123 456 789
  AU: "+61 # ### ####", // 澳大利亚: +61 2 1234 5678
  DE: "+49 ### ########", // 德国: +49 123 45678901
  FR: "+33 # ## ## ## ##", // 法国: +33 1 23 45 67 89
  JP: "+81 # ####-####", // 日本: +81 3 1234-5678
  CN: "+86 ### #### ####", // 中国: +86 138 1234 5678
  IN: "+91 ### #######", // 印度: +91 123 4567890
  BR: "+55 (##) #####-####", // 巴西: +55 (11) 12345-6789
  RU: "+7 (###) ###-##-##", // 俄罗斯: +7 (123) 456-78-90
  IT: "+39 ### ########", // 意大利: +39 123 45678901
  KR: "+82 ###-####-####", // 韩国: +82 10-1234-5678
  ES: "+34 ### #######", // 西班牙: +34 123 456789
  MX: "+52 (##) ####-####", // 墨西哥: +52 (12) 1234-5678
  ID: "+62 ### ##########", // 印度尼西亚: +62 123 456789012
  TR: "+90 (##) ### ## ##", // 土耳其: +90 (12) 345 67 89
  NL: "+31 ### ######", // 荷兰: +31 123 456789
  CH: "+41 ## #######", // 瑞士: +41 12 3456789
  SE: "+46 ### ### ###", // 瑞典: +46 123 456 789
  NO: "+47 ### ## ###", // 挪威: +47 123 45 678
  DK: "+45 #### ####", // 丹麦: +45 1234 5678
  FI: "+358 ### ######", // 芬兰: +358 123 456789
  PL: "+48 ### ### ###", // 波兰: +48 123 456 789
  PT: "+351 ### ### ###", // 葡萄牙: +351 123 456 789
  GR: "+30 ### #######", // 希腊: +30 123 4567890
  BE: "+32 ## ### ####", // 比利时: +32 12 345 6789
  AT: "+43 ### #######", // 奥地利: +43 123 4567890
  IE: "+353 ### ######", // 爱尔兰: +353 123 456789
  NZ: "+64 # ### ####", // 新西兰: +64 2 123 4567
  SG: "+65 ### #######", // 新加坡: +65 123 456789
  MY: "+60 # ### ####", // 马来西亚: +60 12 345 6789
  TH: "+66 ### ### ####", // 泰国: +66 123 456 7890
  PH: "+63 ### ######", // 菲律宾: +63 123 456789
  VN: "+84 ### ### ####", // 越南: +84 123 456 7890
  ZA: "+27 ### ### ####" // 南非: +27 123 456 7890
};

// 各国常用号码段规则
const countryNumberRanges: Record<string, string[]> = {
  // 中国手机号码段
  CN: ["130", "131", "132", "133", "134", "135", "136", "137", "138", "139", 
       "145", "146", "147", "148", "149", 
       "150", "151", "152", "153", "155", "156", "157", "158", "159", 
       "165", "166", "167", 
       "170", "171", "172", "173", "175", "176", "177", "178", 
       "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", 
       "191", "193", "195", "196", "197", "198", "199"],
  // 美国常用区号
  US: ["201", "202", "203", "205", "206", "207", "208", "209", "210", "212", 
       "213", "214", "215", "216", "217", "218", "219", "224", "225", "228", 
       "229", "231", "234", "239", "240", "248", "251", "252", "253", "254"],
  // 英国常用区号
  GB: ["121", "122", "123", "124", "125", "127", "128", "131", "132", "133", 
       "134", "135", "136", "137", "138", "139", "141", "142", "143", "144"],
  // 日本常用区号
  JP: ["03", "04", "05", "06", "07", "08", "09", "011", "012", "013", 
       "014", "015", "016", "017", "018", "019", "022", "023", "024", "025"],
  // 韩国常用手机号码段
  KR: ["010", "011", "016", "017", "018", "019"],
  // 德国常用区号
  DE: ["015", "016", "017", "018", "019", "020", "021", "022", "023", "024"],
  // 法国常用区号
  FR: ["01", "02", "03", "04", "05", "06", "07"],
  // 澳大利亚常用区号
  AU: ["02", "03", "04", "07", "08"],
  // 加拿大常用区号
  CA: ["204", "226", "236", "249", "250", "289", "306", "343", "365", "387", 
       "403", "416", "418", "431", "437", "450", "506", "514", "519", "548"],
  // 印度常用手机号码段
  IN: ["91", "92", "93", "94", "95", "96", "97", "98", "99"],
  // 巴西常用区号
  BR: ["11", "12", "13", "14", "15", "16", "17", "18", "19", "21", 
       "22", "24", "27", "28", "31", "32", "33", "34", "35", "37"],
  // 俄罗斯常用区号
  RU: ["900", "901", "902", "903", "904", "905", "906", "908", "909", "910", 
       "911", "912", "913", "914", "915", "916", "917", "918", "919", "920"],
  // 西班牙常用区号
  ES: ["600", "601", "602", "603", "604", "605", "606", "607", "608", "609", 
       "610", "611", "612", "613", "614", "615", "616", "617", "618", "619"],
  // 意大利常用区号
  IT: ["320", "327", "330", "331", "333", "334", "335", "336", "337", "338", 
       "339", "340", "341", "342", "343", "344", "345", "346", "347", "348"],
  // 墨西哥常用区号
  MX: ["01", "044", "045", "12", "13", "14", "15", "16", "17", "18", 
       "19", "22", "23", "24", "25", "26", "27", "28", "29", "31"],
  // 印度尼西亚常用手机号码段
  ID: ["811", "812", "813", "814", "815", "816", "817", "818", "819", "821", 
       "822", "823", "828", "831", "832", "833", "852", "853", "855", "856"],
  // 土耳其常用区号
  TR: ["530", "531", "532", "533", "534", "535", "536", "537", "538", "539", 
       "540", "541", "542", "543", "544", "545", "546", "547", "548", "549"],
  // 荷兰常用手机号码段
  NL: ["61", "62", "63", "64", "65", "66", "67", "68", "69"],
  // 瑞士常用手机号码段
  CH: ["75", "76", "77", "78", "79"],
  // 瑞典常用手机号码段
  SE: ["70", "72", "73", "76", "77", "79"],
  // 挪威常用手机号码段
  NO: ["40", "41", "42", "44", "45", "46", "47", "48", "49"],
  // 丹麦常用手机号码段
  DK: ["20", "21", "22", "23", "24", "25", "26", "27", "28", "29", 
       "30", "31", "32", "33", "34", "35", "36", "37", "38", "39"],
  // 芬兰常用手机号码段
  FI: ["40", "41", "42", "43", "44", "45", "46", "47", "48", "49", 
       "50", "51", "52", "53", "54", "55", "56", "57", "58", "59"],
  // 波兰常用手机号码段
  PL: ["45", "50", "51", "53", "57", "60", "66", "69", "72", "73", 
       "78", "79", "88"],
  // 葡萄牙常用手机号码段
  PT: ["91", "92", "93", "96"],
  // 希腊常用手机号码段
  GR: ["690", "693", "694", "695", "697", "698", "699"],
  // 比利时常用手机号码段
  BE: ["47", "48", "49"],
  // 奥地利常用手机号码段
  AT: ["650", "651", "652", "653", "654", "655", "656", "657", "658", "659", 
       "660", "661", "662", "663", "664", "665", "666", "667", "668", "669"],
  // 爱尔兰常用手机号码段
  IE: ["83", "85", "86", "87", "89"],
  // 新西兰常用手机号码段
  NZ: ["21", "22", "27", "28", "29"],
  // 新加坡常用手机号码段
  SG: ["81", "82", "83", "84", "85", "86", "87", "88", "89", "90", 
       "91", "92", "93", "94", "95", "96", "97", "98", "99"],
  // 马来西亚常用手机号码段
  MY: ["10", "11", "12", "13", "14", "15", "16", "17", "18", "19"],
  // 泰国常用手机号码段
  TH: ["6", "8", "9"],
  // 菲律宾常用手机号码段
  PH: ["905", "906", "907", "908", "909", "915", "916", "917", "918", "919", 
       "920", "921", "922", "923", "925", "926", "927", "928", "929", "930"],
  // 越南常用手机号码段
  VN: ["32", "33", "34", "35", "36", "37", "38", "39", "52", "56", 
       "58", "59", "70", "76", "77", "78", "79", "83", "84", "85", 
       "86", "88", "89", "90", "91", "92", "93", "94", "96", "97", 
       "98", "99"],
  // 南非常用手机号码段
  ZA: ["71", "72", "73", "74", "76", "78", "81", "82", "83", "84", 
       "86", "87", "88", "89", "91", "92", "93", "94", "95", "96", 
       "97", "98", "99"]
};

/**
 * 根据国家代码生成电话号码
 * @param countryCode 国家代码
 * @returns 格式化的电话号码
 */
export function generatePhoneNumber(countryCode: string): string {
  const format = countryPhoneFormats[countryCode] || "+1 (###) ###-####"; // 默认美国格式
  
  // 生成随机数字，替换格式中的#符号
  let phoneNumber = format;
  
  // 特殊处理各国号码段规则
  if (countryNumberRanges[countryCode]) {
    const ranges = countryNumberRanges[countryCode];
    // 随机选择一个号码段
    const randomRange = ranges[Math.floor(Math.random() * ranges.length)];
    
    // 找到格式中需要替换的第一个#序列
    const firstHashMatch = phoneNumber.match(/#+/);
    if (firstHashMatch) {
      const firstHashIndex = phoneNumber.indexOf(firstHashMatch[0]);
      const hashLength = firstHashMatch[0].length;
      
      // 确保随机号码段长度与需要替换的#长度匹配
      let formattedRange = randomRange;
      if (formattedRange.length < hashLength) {
        // 如果号码段长度不足，后面补0
        formattedRange = formattedRange.padEnd(hashLength, '0');
      } else if (formattedRange.length > hashLength) {
        // 如果号码段长度过长，截取前面部分
        formattedRange = formattedRange.substring(0, hashLength);
      }
      
      // 替换第一个#序列为实际号码段
      phoneNumber = phoneNumber.substring(0, firstHashIndex) + formattedRange + phoneNumber.substring(firstHashIndex + hashLength);
    }
  }
  
  // 替换剩余的#为随机数字
  while (phoneNumber.includes("#")) {
    phoneNumber = phoneNumber.replace("#", Math.floor(Math.random() * 10).toString());
  }
  
  return phoneNumber;
}

/**
 * 根据国家名称获取国家代码
 * @param countryName 国家名称
 * @returns 国家代码
 */
export function getCountryCode(countryName: string): string {
  // 这里需要一个国家名称到国家代码的映射表
  // 暂时使用一个简化版本，实际应该使用完整的映射表
  const countryNameToCode: Record<string, string> = {
    "United States": "US",
    "Canada": "CA",
    "United Kingdom": "GB",
    "Australia": "AU",
    "Germany": "DE",
    "France": "FR",
    "Japan": "JP",
    "China": "CN",
    "India": "IN",
    "Brazil": "BR",
    "Russia": "RU",
    "Italy": "IT",
    "South Korea": "KR",
    "Spain": "ES",
    "Mexico": "MX",
    "Indonesia": "ID",
    "Turkey": "TR",
    "Netherlands": "NL",
    "Switzerland": "CH",
    "Sweden": "SE",
    "Norway": "NO",
    "Denmark": "DK",
    "Finland": "FI",
    "Poland": "PL",
    "Portugal": "PT",
    "Greece": "GR",
    "Belgium": "BE",
    "Austria": "AT",
    "Ireland": "IE",
    "New Zealand": "NZ",
    "Singapore": "SG",
    "Malaysia": "MY",
    "Thailand": "TH",
    "Philippines": "PH",
    "Vietnam": "VN",
    "South Africa": "ZA"
  };
  
  return countryNameToCode[countryName] || "US"; // 默认美国
}
